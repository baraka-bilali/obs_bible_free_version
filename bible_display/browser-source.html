<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible Display - OBS Browser Source</title>
    <link rel="stylesheet" href="../common/css/style-source.css">
    <link rel="stylesheet" href="../common/css/themes/dark/theme.css">
    <script src="../common/js/jquery.js"></script>
    <script src="../common/js/versets.js"></script>
</head>
<body>
    <div class="bible-display-container">
        <!-- Affichage du verset actuel -->
        <div class="verse-display" id="verseDisplay">
            <div class="verse-content">
                <h2 class="verse-reference" id="verseReference">Genèse 1:1 (LSG)</h2>
                <p class="verse-text" id="verseText">Au commencement, Dieu créa les cieux et la terre.</p>
                <p class="verse-source" id="verseSource"></p>
            </div>
        </div>

        <!-- Animation de transition -->
        <div class="verse-animation" id="verseAnimation"></div>
    </div>

    <script>
        // Cette page se rafraîchit automatiquement en lisant les données depuis le control-panel
        
        function updateVerseDisplay() {
            // Récupérer les données du verset actuel
            // Les données seront mises à jour par le control-panel
            
            const reference = localStorage.getItem('currentVerseReference') || '';
            const text = localStorage.getItem('currentVerseText') || '';
            const source = localStorage.getItem('currentVerseSource') || 'Louis Segond';

            if (reference && text) {
                $('#verseReference').text(reference + ' (' + source.substring(0, 3).toUpperCase() + ')');
                $('#verseText').text(text);
                $('#verseSource').text('');
                
                // Ajouter une animation
                $('#verseDisplay').addClass('fade-in');
                setTimeout(() => {
                    $('#verseDisplay').removeClass('fade-in');
                }, 500);
            }
        }

        // Vérifier les mises à jour toutes les 500ms
        setInterval(updateVerseDisplay, 500);
        
        // Appel initial
        updateVerseDisplay();

        // Écouter les changements de localStorage
        window.addEventListener('storage', function(e) {
            if (e.key === 'currentVerseReference' || e.key === 'currentVerseText') {
                updateVerseDisplay();
            }
        });
    </script>
</body>
</html>
